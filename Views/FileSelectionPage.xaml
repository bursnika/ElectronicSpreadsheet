<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:services="clr-namespace:ElectronicSpreadsheet.Services"
             x:Class="ElectronicSpreadsheet.Views.FileSelectionPage"
             Title="ðŸ“‚ Ð’Ð¸Ð±ÐµÑ€Ñ–Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»">

    <ContentPage.Resources>
        <ResourceDictionary>
            <Color x:Key="PrimaryPink">#FF69B4</Color>
            <Color x:Key="LightPink">#FFB6C1</Color>
            <Color x:Key="SoftPink">#FFC0CB</Color>
            <Color x:Key="PastelPink">#FFE4E1</Color>
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid RowDefinitions="Auto,*,Auto" Padding="10">
        <!-- Header -->
        <Border Grid.Row="0" Padding="15" Margin="0,0,0,10">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                    <GradientStop Color="{StaticResource PastelPink}" Offset="0.0" />
                    <GradientStop Color="{StaticResource LightPink}" Offset="1.0" />
                </LinearGradientBrush>
            </Border.Background>
            <Label Text="ðŸ“Š ÐžÐ±ÐµÑ€Ñ–Ñ‚ÑŒ Ñ‚Ð°Ð±Ð»Ð¸Ñ†ÑŽ Ð´Ð»Ñ Ð·Ð°Ð²Ð°Ð½Ñ‚Ð°Ð¶ÐµÐ½Ð½Ñ"
                   FontSize="18"
                   FontAttributes="Bold"
                   TextColor="White"
                   HorizontalTextAlignment="Center" />
        </Border>

        <!-- Scrollable File List -->
        <Border Grid.Row="1"
                BackgroundColor="White"
                Stroke="{StaticResource LightPink}"
                StrokeThickness="2"
                Padding="5">
            <Border.StrokeShape>
                <RoundRectangle CornerRadius="10" />
            </Border.StrokeShape>

            <ScrollView>
                <CollectionView x:Name="FilesCollection"
                                SelectionMode="Single"
                                SelectionChanged="OnFileSelected">
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="services:GoogleDriveFile">
                            <Border Padding="15,10" Margin="5">
                                <Border.GestureRecognizers>
                                    <TapGestureRecognizer Tapped="OnFileTapped" />
                                </Border.GestureRecognizers>
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="8" />
                                </Border.StrokeShape>
                                <Border.Triggers>
                                    <DataTrigger TargetType="Border"
                                                 Binding="{Binding Source={RelativeSource Self}, Path=IsEnabled}"
                                                 Value="True">
                                        <Setter Property="BackgroundColor" Value="{StaticResource PastelPink}" />
                                    </DataTrigger>
                                </Border.Triggers>

                                <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="10">
                                    <Label Grid.Column="0"
                                           Text="ðŸ“„"
                                           FontSize="24"
                                           VerticalOptions="Center" />

                                    <VerticalStackLayout Grid.Column="1" VerticalOptions="Center">
                                        <Label Text="{Binding Name}"
                                               FontSize="16"
                                               FontAttributes="Bold"
                                               TextColor="#333" />
                                        <Label Text="{Binding ModifiedTime, StringFormat='Ð—Ð¼Ñ–Ð½ÐµÐ½Ð¾: {0:dd.MM.yyyy HH:mm}'}"
                                               FontSize="12"
                                               TextColor="#666" />
                                    </VerticalStackLayout>

                                    <Label Grid.Column="2"
                                           Text="â–¶"
                                           FontSize="18"
                                           TextColor="{StaticResource PrimaryPink}"
                                           VerticalOptions="Center" />
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </ScrollView>
        </Border>

        <!-- Cancel Button -->
        <Button Grid.Row="2"
                Text="âŒ Ð¡ÐºÐ°ÑÑƒÐ²Ð°Ñ‚Ð¸"
                Clicked="OnCancelClicked"
                BackgroundColor="{StaticResource LightPink}"
                TextColor="White"
                CornerRadius="10"
                Padding="15,10"
                Margin="0,10,0,0"
                FontAttributes="Bold" />
    </Grid>
</ContentPage>
